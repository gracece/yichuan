<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML5 canvas demo</title>
    <link rel="stylesheet" href="/static/css/bootstrap.min.css" type="text/css"/>
    <style type="text/css" media="all">
      #myCanvas
      {
        background-image:url('{{ static_url('upload/grace-0.png')}}');
        background-repeat:no-repeat;
        }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col-md-1">
          <button id="clear" class="btn">clear</button>
        </div>
        <div class="col-md-9">
          <canvas id="myCanvas"  width="900" height="950"> </canvas>
        </div>
      </div>
    </div>

    <script src='{{ static_url ("js/jquery.min.js")}}'></script>
    <script src='{{ static_url ("js/bootstrap.min.js")}}'></script>
    <script src=' {{ static_url("js/jcanvas.js")}} 'type="text/javascript"></script>
    <script type="text/javascript">
      var timestamp = 0;
      var xxa;
      $('#clear').click(function(){
        $.get("/clear",function(){
          location.reload();
        });
      });
      function getLine(){
        $.getJSON("draw?t="+timestamp,function(data){

          $.each(data,function(i,ONE){
            timestamp = ONE.timestamp;
            type = ONE.type;
            if(type=='draw') {
              item = ONE.line;
              console.log(item);
              $('canvas').drawLine({
                strokeStyle: 'blue',
                strokeWidth: 5,
                rounded: true,
                x1: item.x1, y1: item.y1,
                x2: item.x2, y2: item.y2,
              });
            }
            else if(type='jump')
              {
                page = ONE.page-1;
                url = "/static/upload/grace-"+page+".png";
                console.log("page"+url);
                $('#myCanvas').css("background-image",'url('+url+')')
                $('canvas').clearCanvas();
              }
          });
        });
        setTimeout("getLine()",500);
      }
      getLine();
    </script>
  </body>
</html>
